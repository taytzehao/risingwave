(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[980],{92299:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/await_tree",function(){return r(49944)}])},14993:function(e,t,r){"use strict";r.d(t,{OL:function(){return i},X8:function(){return a},xv:function(){return o}});var c=r(77617),n=r(79897);async function a(){let e=await n.Z.get("/api/metrics/cluster");return e}async function o(){let e=(await n.Z.get("/api/clusters/1")).map(c.cX.fromJSON);return e}async function i(){let e=(await n.Z.get("/api/clusters/2")).map(c.cX.fromJSON);return e}},6935:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var c=r(66479),n=r(67294);function a(e){let[t,r]=(0,n.useState)(),a=(0,c.pm)();return(0,n.useEffect)(()=>{let t=async()=>{try{let t=await e();r(t)}catch(e){a({title:"Error Occurred",description:e.toString(),status:"error",duration:5e3,isClosable:!0}),console.error(e)}};t()},[a,e]),{response:t}}},49944:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var c=r(85893),n=r(40639),a=r(83234),o=r(57026),i=r(47741),s=r(19604),l=r(96486),u=r.n(l),d=r(9008),f=r.n(d),p=r(67294),T=r(42571),h=r(96756);let m={fromJSON:e=>({actorTraces:g(e.actorTraces)?Object.entries(e.actorTraces).reduce((e,t)=>{let[r,c]=t;return e[Number(r)]=String(c),e},{}):{},rpcTraces:g(e.rpcTraces)?Object.entries(e.rpcTraces).reduce((e,t)=>{let[r,c]=t;return e[r]=String(c),e},{}):{},compactionTaskTraces:g(e.compactionTaskTraces)?Object.entries(e.compactionTaskTraces).reduce((e,t)=>{let[r,c]=t;return e[r]=String(c),e},{}):{}}),toJSON(e){let t={};if(e.actorTraces){let r=Object.entries(e.actorTraces);r.length>0&&(t.actorTraces={},r.forEach(e=>{let[r,c]=e;t.actorTraces[r]=c}))}if(e.rpcTraces){let r=Object.entries(e.rpcTraces);r.length>0&&(t.rpcTraces={},r.forEach(e=>{let[r,c]=e;t.rpcTraces[r]=c}))}if(e.compactionTaskTraces){let r=Object.entries(e.compactionTaskTraces);r.length>0&&(t.compactionTaskTraces={},r.forEach(e=>{let[r,c]=e;t.compactionTaskTraces[r]=c}))}return t},create:e=>m.fromPartial(null!=e?e:{}),fromPartial(e){var t,r,c;let n={actorTraces:{},rpcTraces:{},compactionTaskTraces:{}};return n.actorTraces=Object.entries(null!==(t=e.actorTraces)&&void 0!==t?t:{}).reduce((e,t)=>{let[r,c]=t;return void 0!==c&&(e[Number(r)]=String(c)),e},{}),n.rpcTraces=Object.entries(null!==(r=e.rpcTraces)&&void 0!==r?r:{}).reduce((e,t)=>{let[r,c]=t;return void 0!==c&&(e[r]=String(c)),e},{}),n.compactionTaskTraces=Object.entries(null!==(c=e.compactionTaskTraces)&&void 0!==c?c:{}).reduce((e,t)=>{let[r,c]=t;return void 0!==c&&(e[r]=String(c)),e},{}),n}};function g(e){return"object"==typeof e&&null!==e}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:window;var j=r(79897),v=r(14993),w=r(6935);function x(){let{response:e}=(0,w.Z)(v.OL),[t,r]=(0,p.useState)(),[l,d]=(0,p.useState)("");(0,p.useEffect)(()=>{e&&!t&&e.length>0&&r(e[0].id)},[e,t]);let g=async()=>{let e;let r="Await-Tree Dump of Compute Node ".concat(t,":");d(void 0);try{let c=m.fromJSON(await j.Z.get("/api/monitor/await_tree/".concat(t))),n=u()(c.actorTraces).entries().map(e=>{let[t,r]=e;return"[Actor ".concat(t,"]\n").concat(r)}).join("\n"),a=u()(c.rpcTraces).entries().map(e=>{let[t,r]=e;return"[RPC ".concat(t,"]\n").concat(r)}).join("\n");e="".concat(r,"\n\n").concat(n,"\n").concat(a)}catch(t){e="".concat(r,"\n\nError: ").concat(t.message)}d(e)},x=(0,c.jsxs)(n.kC,{p:3,height:"calc(100vh - 20px)",flexDirection:"column",children:[(0,c.jsx)(h.Z,{children:"Await Tree Dump"}),(0,c.jsxs)(n.kC,{flexDirection:"row",height:"full",width:"full",children:[(0,c.jsx)(n.gC,{mr:3,spacing:3,alignItems:"flex-start",width:200,height:"full",children:(0,c.jsxs)(a.NI,{children:[(0,c.jsx)(a.lX,{children:"Compute Nodes"}),(0,c.jsxs)(n.gC,{children:[(0,c.jsx)(o.Ph,{onChange:e=>r(parseInt(e.target.value)),children:e&&e.map(e=>{var t,r;return(0,c.jsxs)("option",{value:e.id,children:["(",e.id,") ",null===(t=e.host)||void 0===t?void 0:t.host,":",null===(r=e.host)||void 0===r?void 0:r.port]},e.id)})}),(0,c.jsx)(i.zx,{onClick:e=>g(),width:"full",children:"Dump"})]})]})}),(0,c.jsx)(n.xu,{flex:1,height:"full",ml:3,overflowX:"scroll",overflowY:"scroll",children:void 0===l?(0,c.jsx)(T.Z,{}):(0,c.jsx)(s.ZP,{language:"sql",options:{fontSize:13,readOnly:!0,renderWhitespace:"boundary",wordWrap:"on"},defaultValue:'Select a compute node and click "Dump"...',value:l})})]})]});return(0,c.jsxs)(p.Fragment,{children:[(0,c.jsx)(f(),{children:(0,c.jsx)("title",{children:"Await Tree Dump"})}),x]})}}},function(e){e.O(0,[662,235,575,774,888,179],function(){return e(e.s=92299)}),_N_E=e.O()}]);